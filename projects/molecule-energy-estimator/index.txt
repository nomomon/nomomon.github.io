3:I[5613,[],""]
5:I[1778,[],""]
6:I[9553,["250","static/chunks/250-d4164d91bfac7d8a.js","185","static/chunks/app/layout-6e4745ad230dd53f.js"],"NavBar"]
4:["slug","projects/molecule-energy-estimator","oc"]
0:["9BGyVfa74BKrtkKxWZ1-r",[[["",{"children":[["slug","projects/molecule-energy-estimator","oc"],{"children":["__PAGE__?{\"slug\":[\"projects\",\"molecule-energy-estimator\"]}",{}]}]},"$undefined","$undefined",true],["",{"children":[["slug","projects/molecule-energy-estimator","oc"],{"children":["__PAGE__",{},["$L1","$L2",null]]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","$4","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}]]},[null,["$","html",null,{"lang":"en","children":["$","body",null,{"className":"__className_aaf875","children":[["$","$L6",null,{}],["$","main",null,{"className":"mt-2 m-auto max-w-4xl py-16 max-md:px-4 max-md:max-w-full","children":["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":"404"}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],"notFoundStyles":[],"styles":null}]}],["$","hr",null,{"className":"w-full max-w-4xl m-auto max-md:max-w-full max-md:px-4"}],["$","footer",null,{"children":["$","div",null,{"className":"w-full max-w-4xl my-6 flex justify-between m-auto max-md:max-w-full max-md:px-4","children":[["$","span",null,{"className":"text-sm text-muted-foreground","children":["nomomon © ",2024]}],["$","span",null,{"children":"☁️"}]]}]}]]}]}],null]],[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/af35e6bd8f5544cf.css","precedence":"next","crossOrigin":""}],["$","link","1",{"rel":"stylesheet","href":"/_next/static/css/a6874c82889c65c5.css","precedence":"next","crossOrigin":""}]],"$L7"]]]]
8:T255a,<h1>Molecule Energy Estimator (RuCode 5.0)</h1>
<p><img src="./assets/rucode-5.0-preview.gif" alt="thumbnail"></p>
<p>This project started off from me participating in the <a href="https://rucode.net/">RuCode 5.0</a> hackathon and then led me to write a research report on the topic. Initially, the problem and data were provided by <a href="https://airi.net/">Artificial Intelligence Research Institute</a>.</p>
<p>The chemical and physical properties of a molecule are determined not only by its structural formula, but also by its conformation – positions of atoms in 3d space. An important task when working with molecules is the estimation of their energies. Currently avaliable approxiamtion methods, such as <a href="https://en.wikipedia.org/wiki/Density_functional_theory">DFT</a>, have high accuracy but are computationally expensive.</p>
<p>One proven approach for predicting conformational energies and other chemical and physical properties is the use of GNNs (Graphed Neural Networks) [<a href="https://arxiv.org/abs/1706.08566">Schrödinger network</a>, <a href="https://arxiv.org/abs/2003.03123">Directional Message Passing for Molecular Graphs</a>].</p>
<p>In this competition, you need to learn how to predict energy from a three-dimensional representation of a molecule. You will be given a set of conformations for a subsample of molecules from the <a href="https://github.com/molecularsets/moses">MOSES</a> dataset. For some of the conformations, the energy value will also be given.</p>
<h2>Solution</h2>
<p>The idea of the initial solution was as follows:</p>
<ol>
<li>Energy has two parts: kinetic and potential energy. The kinetic energy will be assumed to be zero because there is no data on molecule is moving. The potential energy is the sum of the potential energies of all the bonds in the molecule. Or, in other words, the potential energy is the sum of function of these two atoms and the distance between them.</li>
</ol>
<p class="katex-block math-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>E</mi><mo>=</mo><munder><mo>∑</mo><mrow><msub><mi>a</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>j</mi></msub><mo>∈</mo><mtext>molecule</mtext></mrow></munder><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>j</mi></msub><mo separator="true">,</mo><msub><mi>d</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">E = \sum_{a_i, a_j \in \text{molecule}}{f(a_i, a_j, d_{(i, j)})}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.5494em;vertical-align:-1.4994em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord text mtight"><span class="mord mtight">molecule</span></span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4994em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span></p>
<ol start="2">
<li>
<p>Energy of a bond is defined in small ranges. So, I made an assumption that it is constant for any two types of atoms.</p>
</li>
<li>
<p>To determine if there is a bond, I checked if the distance between two atoms is smaller than the longest bond length possible.</p>
</li>
<li>
<p>Now, the number of each bond can be passed to a neural network to determine the energy of the molecule. The assumption is that, the neural network will determine the energy of each bond and use that to predict the energy of the molecule.</p>
</li>
</ol>
<p>This is the solution I used in the competition and got to the top 7th place. You can listen to my solution on the <a href="https://www.youtube.com/watch?v=jGRQjQZg4Ck&amp;t=8577s">livestream</a> (only in russian).</p>
<iframe width="560" height="315" style="display:block; margin:auto; margin-bottom:1em; max-width:100%;" src="https://www.youtube.com/embed/jGRQjQZg4Ck?start=8577" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>After the competition, I did deeper research into the problem and found that the problem is not simple. The problem is that the energy of a bond is not a constant. Actually, bonds has multiple <strong>descrete</strong> energy levels, which are determined by the distance between two atoms.</p>
<p>So, I used another way of determining the bond energy level with a constraint satisfaction solver. I proposed new task to my team and they we solved it. Passing the bond energy levels to the neural network gave better results.</p>
<h2>Achievements</h2>
<ul>
<li>
<p><a href="https://www.kaggle.com/competitions/molecular-energy-estimation-rucode/leaderboard">7th place in Yandex RuCode 5.0</a></p>
</li>
<li>
<p><a href="https://nomomon.github.io/molecule-energy-prediction/report/report.pdf">Approximating the energy of molecules from their three-dimensional representations using neural networks</a></p>
</li>
</ul>
2:[false,["$","div",null,{"children":["$","div",null,{"className":"markdown-body","children":["$","article",null,{"dangerouslySetInnerHTML":{"__html":"$8"}}]}]}]]
7:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"Mansur Nurmukhambetov"}],["$","meta","3",{"name":"description","content":"Generated by create next app"}],["$","meta","4",{"name":"next-size-adjust"}]]
1:null
