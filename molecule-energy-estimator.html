<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Molecule Energy Estimator</title><meta name="next-head-count" content="3"/><link rel="icon" href="/logo.svg"/><link rel="preload" href="/_next/static/css/060f2c5631a3598e.css" as="style"/><link rel="stylesheet" href="/_next/static/css/060f2c5631a3598e.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-b8f8d6679aaa5f42.js" defer=""></script><script src="/_next/static/chunks/framework-cda2f1305c3d9424.js" defer=""></script><script src="/_next/static/chunks/main-f11614d8aa7ee555.js" defer=""></script><script src="/_next/static/chunks/pages/_app-891652dd44e1e4e1.js" defer=""></script><script src="/_next/static/chunks/175675d1-1434f301c5e774f6.js" defer=""></script><script src="/_next/static/chunks/9f96d65d-c9e0543547ce45e9.js" defer=""></script><script src="/_next/static/chunks/440-1dd60335387b13c8.js" defer=""></script><script src="/_next/static/chunks/998-6bb348385f3991da.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bslug%5D-2b1b70858d725f5e.js" defer=""></script><script src="/_next/static/hKxayldN43sQ_XdUbpNBj/_buildManifest.js" defer=""></script><script src="/_next/static/hKxayldN43sQ_XdUbpNBj/_ssgManifest.js" defer=""></script></head><body><nav class="flex flex-row px-8 py-4 max-sm:px-2"><a href="/"><div class="flex flex-row items-center"><img src="/logo.svg" alt="logo" class="h-8 w-8 mr-2"/><h1 class="text-xl font-light text-gray-800">Mansur Nurmukhambetov</h1></div></a></nav><div id="__next"><div class="w-full overflow-y-auto"><div class="w-full h-64 py-20 flex flex-col items-center bg-gradient-to-r from-purple-500 to-red-500"><h1 class="text-white text-6xl drop-shadow-md">Molecule Energy Estimator</h1><p class="mb-4 text-white opacity-75 font-light">The chemical and physical properties of a molecule are determined not only by its structural formula, but also by its conformation – positions of atoms in 3d space.</p><div class="text-white opacity-75 text-sm font-light py-1 px-4 rounded-md backdrop-blur-xl bg-black/30">April 1, 2022</div></div><article class="w-full max-w-xl m-auto mt-8 max-sm:px-4"><div class="markdown-body"><p>![[rucode-5.0-preview.gif]]</p>
<p>This project started off from me participating in the <a href="https://rucode.net/">RuCode 5.0</a> hackathon and then led me to write a research report on the topic. Initially, the problem and data were provided by <a href="https://airi.net/">Artificial Intelligence Research Institute</a>.</p>
<p>The chemical and physical properties of a molecule are determined not only by its structural formula, but also by its conformation – positions of atoms in 3d space. An important task when working with molecules is the estimation of their energies. Currently avaliable approxiamtion methods, such as <a href="https://en.wikipedia.org/wiki/Density_functional_theory">DFT</a>, have high accuracy but are computationally expensive.</p>
<p>One proven approach for predicting conformational energies and other chemical and physical properties is the use of GNNs (Graphed Neural Networks) [<a href="https://arxiv.org/abs/1706.08566">Schrödinger network</a>, <a href="https://arxiv.org/abs/2003.03123">Directional Message Passing for Molecular Graphs</a>].</p>
<p>In this competition, you need to learn how to predict energy from a three-dimensional representation of a molecule. You will be given a set of conformations for a subsample of molecules from the <a href="https://github.com/molecularsets/moses">MOSES</a> dataset. For some of the conformations, the energy value will also be given.</p>
<h2>Solution</h2>
<p>The idea of the initial solution was as follows:</p>
<ol>
<li>Energy has two parts: kinetic and potential energy. The kinetic energy will be assumed to be zero because there is no data on molecule is moving. The potential energy is the sum of the potential energies of all the bonds in the molecule. Or, in other words, the potential energy is the sum of function of these two atoms and the distance between them.</li>
</ol>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo>=</mo><msub><mo>∑</mo><mrow><msub><mi>a</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>j</mi></msub><mo>∈</mo><mtext>molecule</mtext></mrow></msub><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>j</mi></msub><mo separator="true">,</mo><msub><mi>d</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">E = \sum_{a_i, a_j \in \text{molecule}}{f(a_i, a_j, d_{(i, j)})}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.247em;vertical-align:-0.497em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1864em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em"><span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord text mtight"><span class="mord mtight">molecule</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.497em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span></p>
<ol start="2">
<li>
<p>Energy of a bond is defined in small ranges. So, I made an assumption that it is constant for any two types of atoms.</p>
</li>
<li>
<p>To determine if there is a bond, I checked if the distance between two atoms is smaller than the longest bond length possible.</p>
</li>
<li>
<p>Now, the number of each bond can be passed to a neural network to determine the energy of the molecule. The assumption is that, the neural network will determine the energy of each bond and use that to predict the energy of the molecule.</p>
</li>
</ol>
<p>This is the solution I used in the competition and got to the top 7th place. You can listen to my solution on the <a href="https://www.youtube.com/watch?v=jGRQjQZg4Ck&amp;t=8577s">livestream</a> (only in russian).</p>
<!-- -->&lt;iframe width=&quot;560&quot; height=&quot;315&quot; style=&quot;display:block; margin:auto; margin-bottom:1em; max-width:100%;&quot; src=&quot;https://www.youtube.com/embed/jGRQjQZg4Ck?start=8577&quot; title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen&gt;&lt;/iframe&gt;<!-- -->
<p>After the competition, I did deeper research into the problem and found that the problem is not simple. The problem is that the energy of a bond is not a constant. Actually, bonds has multiple <strong>discrete</strong> energy levels, which are determined by the distance between two atoms.</p>
<p>So, I used another way of determining the bond energy level with a constraint satisfaction solver. I proposed new task to my team and they we solved it. Passing the bond energy levels to the neural network gave better results.</p>
<h2>Achievements</h2>
<ul>
<li>
<p><a href="https://www.kaggle.com/competitions/molecular-energy-estimation-rucode/leaderboard">7th place in Yandex RuCode 5.0</a></p>
</li>
<li>
<p><a href="https://nomomon.github.io/molecule-energy-prediction/report/report.pdf">Approximating the energy of molecules from their three-dimensional representations using neural networks</a></p>
</li>
</ul></div></article></div></div><footer class="w-full flex flex-row justify-center my-8"><p class="text-gray-500">Made with ❤️ by<a class="text-blue-500 hover:text-blue-700" href="https://github.com/nomomon"> nomomon</a></p></footer><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"fileName":"Molecule Energy Estimator","file":"---\ndescription: \"The chemical and physical properties of a molecule are determined not only by its structural formula, but also by its conformation – positions of atoms in 3d space.\"\nimageURL: rucode-5.0-preview.gif\ndate: 1 Apr, 2022\nendDate: 1 Jul, 2022\nsource: \"https://github.com/nomomon/molecule-energy-prediction\"\ndemo: \"\"\ntags: [tensorflow, pandas, numpy, csp, chemistry, competition, project]\n\n---\n\n![[rucode-5.0-preview.gif]]\n\nThis project started off from me participating in the [RuCode 5.0](https://rucode.net/) hackathon and then led me to write a research report on the topic. Initially, the problem and data were provided by [Artificial Intelligence Research Institute](https://airi.net/).\n\nThe chemical and physical properties of a molecule are determined not only by its structural formula, but also by its conformation – positions of atoms in 3d space. An important task when working with molecules is the estimation of their energies. Currently avaliable approxiamtion methods, such as [DFT](https://en.wikipedia.org/wiki/Density_functional_theory), have high accuracy but are computationally expensive.\n\nOne proven approach for predicting conformational energies and other chemical and physical properties is the use of GNNs (Graphed Neural Networks) [[Schrödinger network](https://arxiv.org/abs/1706.08566), [Directional Message Passing for Molecular Graphs](https://arxiv.org/abs/2003.03123)].\n\nIn this competition, you need to learn how to predict energy from a three-dimensional representation of a molecule. You will be given a set of conformations for a subsample of molecules from the [MOSES](https://github.com/molecularsets/moses) dataset. For some of the conformations, the energy value will also be given.\n\n## Solution\n\nThe idea of the initial solution was as follows:\n\n1. Energy has two parts: kinetic and potential energy. The kinetic energy will be assumed to be zero because there is no data on molecule is moving. The potential energy is the sum of the potential energies of all the bonds in the molecule. Or, in other words, the potential energy is the sum of function of these two atoms and the distance between them.\n\n$$E = \\sum_{a_i, a_j \\in \\text{molecule}}{f(a_i, a_j, d_{(i, j)})}$$\n\n2. Energy of a bond is defined in small ranges. So, I made an assumption that it is constant for any two types of atoms.\n\n3. To determine if there is a bond, I checked if the distance between two atoms is smaller than the longest bond length possible.\n\n4. Now, the number of each bond can be passed to a neural network to determine the energy of the molecule. The assumption is that, the neural network will determine the energy of each bond and use that to predict the energy of the molecule.\n\nThis is the solution I used in the competition and got to the top 7th place. You can listen to my solution on the [livestream](https://www.youtube.com/watch?v=jGRQjQZg4Ck\u0026t=8577s) (only in russian).\n\n\u003ciframe width=\"560\" height=\"315\" style=\"display:block; margin:auto; margin-bottom:1em; max-width:100%;\" src=\"https://www.youtube.com/embed/jGRQjQZg4Ck?start=8577\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen\u003e\u003c/iframe\u003e\n\nAfter the competition, I did deeper research into the problem and found that the problem is not simple. The problem is that the energy of a bond is not a constant. Actually, bonds has multiple **discrete** energy levels, which are determined by the distance between two atoms.\n\nSo, I used another way of determining the bond energy level with a constraint satisfaction solver. I proposed new task to my team and they we solved it. Passing the bond energy levels to the neural network gave better results.\n\n## Achievements\n\n- [7th place in Yandex RuCode 5.0](https://www.kaggle.com/competitions/molecular-energy-estimation-rucode/leaderboard)\n\n- [Approximating the energy of molecules from their three-dimensional representations using neural networks](https://nomomon.github.io/molecule-energy-prediction/report/report.pdf)\n"},"__N_SSG":true},"page":"/[slug]","query":{"slug":"molecule-energy-estimator"},"buildId":"hKxayldN43sQ_XdUbpNBj","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>